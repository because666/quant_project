# 量化项目文件分工手册

## 📖 目录
（该项目文件夹名称为quant_ml_project_）
1.  [项目核心架构图](#一-项目核心架构图)
2.  [配置文件（项目的大脑与规则库）](#二-配置文件-config---项目的大脑与规则库)
3.  [数据模块（项目的原料加工厂）](#三-数据模块-data_module---项目的原料加工厂)
4.  [策略模块（项目的智能决策中心）](#四-策略模块-strategy_module---项目的智能决策中心)
5.  [回测模块（项目的实战模拟与验算中心）](#五-回测模块-backtest_module---项目的实战模拟与验算中心)
6.  [串联与前端模块（项目的总控台与界面）](#六-串联与前端模块-main_app--frontend---项目的总控台与界面)
7.  [给全组的行动建议与鼓励](#七-给全组的终极行动建议与鼓励)
8.  [零基础AI编码提示词规范（必读）](#-零基础ai编码提示词规范必读)

---

## 一、 项目核心架构图

简单来说，数据是这样流动的：
`配置` → `数据模块` → `策略模块` → `回测模块` → `主程序` & `前端界面`

## 二、 配置文件 (`config/`) - 项目的“大脑与规则库”

这里是存放所有固定参数和秘密钥匙的地方，所有其他文件都要从这里读取设置，**禁止**在代码里写死数字或字符串。

| 文件 | 负责人 | 核心功能 | 必须包含的内容示例 | 验收标准 |
| :--- | :--- | :--- | :--- | :--- |
| **`project_config.py`** | 串联组-组员A | **定义全项目统一的参数**，比如股票列表、时间、初始资金等。 | ```python<br>STOCK_LIST = [‘000001’， ‘000002’]<br>START_DATE = ‘2023-01-01’<br>INITIAL_CAPITAL = 100000<br>``` | 1. 其他组员能成功 `import` 这个文件。<br>2. 运行时不报错。 |
| **`strategy_params.yaml`** | 策略组-组员B | **定义策略调参的模板**，方便前端修改和策略读取。 | ```yaml<br>model_name: “RandomForest”<br>stop_loss: 0.05<br>factors: [‘factor_1’， ‘factor_2’]<br>``` | 1. 是一个合法的YAML文件。<br>2. 策略组能成功读取其中的参数。 |
| **`api_config.yaml`** | 数据组-组员A | **安全存放所有外部数据源的密钥**（如Tushare token）。 | ```yaml<br>tushare:<br>  token: ‘你的token’<br>``` | 1. 在 `.gitignore` 中忽略此文件，防止密钥上传。<br>2. 数据获取代码能读取它。 |

## 三、 数据模块 (`data_module/`) - 项目的“原料加工厂”

负责从网络获取数据，并进行清洗、加工，生产出策略模块需要的“原料”。

| 文件 | 负责人 | 核心功能 | 输入 | 输出 | 验收标准（完成标志） |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **`data_fetcher.py`** | 数据组-组员A | **从网络获取原始股票数据**。根据配置里的股票列表和日期，循环获取每只股票的日K线数据。 | `config`中的股票列表、起止日期。 | 1. 一个DataFrame。<br>2. 文件：`outputs/raw_data.parquet` | 运行后，能在`outputs/`文件夹下看到 `raw_data.parquet` 文件，且不是空文件。 |
| **`data_cleaner.py`** | 数据组-组员B | **清洗和标准化数据**。处理缺失值、调整日期格式、排序。 | `raw_data.parquet` | 1. 干净的DataFrame。<br>2. 文件：`outputs/standard_data.parquet` | 能成功读取上游文件，并生成整洁的新数据文件。 |
| **`factor_miner.py`** | 数据组-组员B | **计算基础特征（因子）**。在数据上新增几列，例如5日收益率、量比等。 | `standard_data.parquet` | 增加了因子列的DataFrame。 | 输出的数据包含了新的因子列，并能提供新增的列名清单。 |

**🔗 数据模块协作要点**：
上游完成后需及时告知下游。完成因子计算后，**必须**在群里发布新增的列名清单。

## 四、 策略模块 (`strategy_module/`) - 项目的“智能决策中心”

利用加工好的数据，训练模型，并生成买卖信号。

| 文件 | 负责人 | 核心功能 | 输入 | 输出 | 验收标准（完成标志） |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **`model_trainer.py`** | 策略组-组员A | **训练机器学习模型**。读取因子数据，定义特征和目标，训练一个随机森林模型并保存。 | `standard_data.parquet` (含因子列) | 1. 训练好的模型。<br>2. 文件：`outputs/trained_model.pkl` | 能运行完成并生成可加载的模型文件。 |
| **`factor_optimizer.py`** | 策略组-组员A | **评估因子好坏**。计算因子重要性或相关性，形成报告。 | 因子数据，训练好的模型。 | 因子重要性排名。 | 运行后能看到因子的排名结果。 |
| **`strategy_engine.py`** | 策略组-组员B | **生成交易信号**。加载模型，预测得到每只股票每天的信号（1买入、-1卖出、0持有）。 | 1. `trained_model.pkl`<br>2. 最新的因子数据。 | 1. 包含信号的DataFrame。<br>2. 文件：`outputs/signal.csv` | 生成指定格式的 `signal.csv` 文件。 |

**🔗 策略模块协作要点**：
保存模型后需立即告知搭档路径。生成信号文件后，**必须**在群里发布文件路径和列格式。

## 五、 回测模块 (`backtest_module/`) - 项目的“实战模拟与验算中心”

根据历史信号模拟交易，计算盈亏，并生成绩效报告。

| 文件 | 负责人 | 核心功能 | 输入 | 输出 | 验收标准（完成标志） |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **`backtest_engine.py`** | 回测组-组员A | **模拟交易，计算每日资产**。读取信号和价格，根据规则模拟买卖，记录每天的总资产。 | 1. `signal.csv`<br>2. `standard_data.parquet`<br>3. 初始资金。 | 包含日期和每日资产净值的DataFrame。 | 运行后，能打印出资产曲线的首尾值。 |
| **`performance_analyzer.py`** | 回测组-组员B | **计算核心绩效指标**。根据资产曲线计算总收益率、最大回撤、胜率。 | 每日资产净值DataFrame。 | 包含三个关键指标的字典。 | 运行后，能在终端清晰打印出这三个数字。 |
| **`report_generator.py`** | 回测组-组员B | **生成文字建议报告**。根据绩效指标，写一段简单的文字建议。 | 绩效指标字典。 | 一个文本文件 `report.txt`。 | 生成包含可读文字建议的报告文件。 |

**🔗 回测模块协作要点**：
上游需通过规范方式传递数据给下游。下游计算时，**严禁**手动输入数字，必须全部自动计算。

## 六、 串联与前端模块 (`main_app/` & `frontend/`) - 项目的“总控台与界面”

把各个模块串联起来，并提供用户操作的界面。

| 文件 | 负责人 | 核心功能 | 输入 | 输出 | 验收标准（完成标志） |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **`main.py`** | 串联组-组员A | **程序唯一入口**。就几行代码，用来启动整个程序。 | 无。 | 启动应用。 | 运行 `python main.py` 可以启动，不报错。 |
| **`main_pipeline.py`** | 串联组-组员A | **主流程控制器**。定义一个函数，按顺序“打印”出完整的数据处理、策略、回测步骤。**本周目标：仅用print串联。** | 无。 | 控制台按顺序打印的步骤日志。 | 运行函数，能在控制台看到清晰的步骤提示。 |
| **`data_interface.py`** | 串联组-组员A | **提供统一的数据读取接口**。编写函数让其他组能轻松拿到数据，不用自己写复杂路径。 | 无。 | 返回给其他模块的DataFrame。 | 其他组员能通过调用你的函数轻松拿到数据。 |
| **`risk_manager.py`** | 串联组-组员B | **执行风控规则**。监控市场指数，若触发条件则返回“清仓”信号。 | 指数历史数据。 | 风控信号：`True`（正常）或`False`（触发）。 | 能返回一个布尔值。 |
| **`frontend/`下所有文件** | 串联组-组员B | **搭建图形界面**。用Streamlit库创建一个Web界面。**第一版只需实现**：一个标题、一个“开始回测”按钮。 | 用户点击按钮。 | 一个本地运行的网页。 | 能打开网页，点击按钮后控制台有反应。 |

**🔗 串联模块协作要点**：
界面按钮绑定的函数名必须与流程控制器里的函数名完全一致。两人需共同确定。

## 七、 给全组的终极行动建议与鼓励

1.  **从“能跑通”开始**：每个文件的第一版目标，不是完美，而是**实现正确的输入输出对接**。哪怕只处理一只股票的数据，只要生成约定格式的文件，就是胜利！
2.  **接受“不完美但可用”的代码**：初期代码可能不优雅，但只要它能跑通并完成接口任务，就是好代码。优化是以后的事。
3.  **验收看事实，不看感觉**：你的工作是否完成，**由“约定的输出文件是否存在且能用”来判定**。请用这个标准要求自己和搭档。
4.  **我们是一个接力队**：你手中的文件，就像接力棒。只有你清晰地交给下一个人，比赛才能继续。**主动交棒，主动确认**，是最高效的合作。

---

# 🧠 零基础AI编码提示词规范（必读！）

用好AI辅助编码，可以遵循下面这个“万能公式”。把下面五段话**复制**到你的AI对话框，然后按你的任务修改【】里的内容。

## 一、 核心：AI提示词“万能公式”

```
【第一句：定角色】
请你扮演一位经验丰富的Python量化工程师，正在严格遵循一个已有架构的项目进行开发。

【第二句：给上下文】
项目根目录是 `quant_ml_project/`。我的任务是完成其中的一个特定文件，文件完整路径是：【请填写你的文件路径，例如：quant_ml_project/data_module/data_fetcher.py】。

【第三句：说要求】
请为这个文件编写完整、可运行的Python代码，实现以下**具体功能**：
1. 功能点1：【必须非常具体，例如：定义一个名为 `fetch_stock_data` 的函数，接受 `symbol_list`， `start_date`， `end_date` 三个参数】。
2. 功能点2：【例如：使用AKShare库，获取这些股票在指定日期的日线数据】。
3. 功能点3：【例如：将数据保存到项目内的 `data_module/outputs/raw_data.parquet` 文件】。
请使用pandas和numpy库，代码需添加清晰的中文注释。

【第四句：锁接口（最重要！）】
请务必严格遵守以下项目约定，否则代码将无法与队友对接：
- **输入**：函数参数的形式必须为【例如：(symbol_list: list， start_date: str， end_date: str)】。
- **输出**：函数的返回值必须是【例如：一个pandas DataFrame，同时将数据保存到指定路径】。
- **文件与路径**：生成的数据/模型文件**必须**保存到【例如：`data_module/outputs/raw_data.parquet`】，不能是其他路径。
- **列名规范**：数据表的列名**必须**为：【例如：[‘date’， ‘symbol’， ‘open’， ‘high’， ‘low’， ‘close’， ‘volume’]】。
- **配置读取**：所有参数（如股票列表、开始日期）**必须**从 `quant_ml_project/config/project_config.py` 中导入，不要写死在代码里。

【第五句：避坑指南】
编写代码时请注意：
1. 添加必要的异常处理（如网络请求失败）。
2. 避免使用绝对路径，全部使用相对于项目根目录的路径。
3. 打印一些进度信息（如“正在获取XXX股票数据”）。
```

## 二、 各文件提示词示例（可直接复制使用）

### **数据模块**
**文件：`data_fetcher.py` （数据组-组员A）**
```
（使用上面的万能公式，【】内内容替换如下）
【文件路径】：quant_ml_project/data_module/data_fetcher.py
【功能点1】：定义一个名为 `fetch_stock_data` 的函数。
【功能点2】：函数从 `config/project_config.py` 导入 `STOCK_LIST`， `START_DATE`， `END_DATE` 作为默认参数。
【功能点3】：使用AKShare库，循环获取`STOCK_LIST`中每只股票的日线数据。
【功能点4】：将所有数据合并，并保存到 `data_module/outputs/raw_data.parquet`。
【输入】：函数应允许覆盖默认参数。
【输出】：返回合并后的DataFrame，并保存文件。
【列名】：[‘date’， ‘symbol’， ‘open’， ‘high’， ‘low’， ‘close’， ‘volume’]
```

### **策略模块**
**文件：`model_trainer.py` （策略组-组员A）**
```
【文件路径】：quant_ml_project/strategy_module/model_trainer.py
【功能点1】：定义一个名为 `train_model` 的函数。
【功能点2】：从 `data_module/outputs/standard_data.parquet` 读取数据。
【功能点3】：准备特征(X)和目标(y)：使用除`date`， `symbol`， `close`外的列作为特征，以`close`列未来5日的涨跌作为目标。
【功能点4】：使用`sklearn`的`RandomForestClassifier`训练一个分类模型。
【功能点5】：将训练好的模型保存到 `strategy_module/outputs/trained_model.pkl`。
【输入】：`train_test_split`的比例等参数可从`config/strategy_params.yaml`读取。
【输出】：返回训练好的模型对象，并保存模型文件。
```

## 三、 提交工作成果前的“三步自检法”

写完代码后，**不要直接说“我完成了”**，按下面三步检查一下：

1.  **第一步：独立运行**
    ```bash
    cd quant_ml_project  # 首先进入项目文件夹
    python 你的文件.py    # 运行你的脚本
    ```
    **成功标志**：没有红色报错，并打印出类似“数据已保存到XXX”的提示。

2.  **第二步：验证输出**
    去文件夹里找到你代码承诺要生成的文件（如`raw_data.parquet`），**确认它确实存在**，并且不是空文件。

3.  **第三步：在群里按格式提交**
    > 【数据组-张三】文件完成并已验证
    > 文件：`data_fetcher.py`
    > 功能：已实现从AKShare获取数据，并读取config配置。
    > 输出文件：`data_module/outputs/raw_data.parquet` （文件大小：XX KB）
    > **接口就绪**：我的搭档@李四，你可以用你的`data_cleaner.py`读取我这个文件进行测试了。

## 四、 最重要的两条“军规”

1.  **路径是生命线**：所有文件路径**必须**和分工表里写的一模一样。如果你改了，你的搭档就会失败。
2.  **先跑通，再优化**：第一个目标是生成一个**能跑起来、能生成约定文件**的“简陋”版本。不要追求完美，先保证“有”。
